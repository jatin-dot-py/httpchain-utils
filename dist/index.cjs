"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const V=require("zustand"),e=require("react/jsx-runtime"),v=require("react"),x=require("lucide-react"),K=require("clsx"),Y=require("tailwind-merge"),O=require("class-variance-authority"),g=require("radix-ui"),X=require("react-window"),Z=require("@radix-ui/react-tabs"),ee=require("react-syntax-highlighter"),te=require("react-syntax-highlighter/dist/esm/styles/prism");function se(t){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const a in t)if(a!=="default"){const n=Object.getOwnPropertyDescriptor(t,a);Object.defineProperty(s,a,n.get?n:{enumerable:!0,get:()=>t[a]})}}return s.default=t,Object.freeze(s)}const y=se(Z);function E(t,s){if(!t)return;const a=s.toLowerCase(),n=Object.keys(t).find(o=>o.toLowerCase()===a);return n?t[n]:void 0}function ne(t){if(!t)return{};const s={};return t.split(";").forEach(a=>{const[n,...o]=a.split("=");n&&(s[n.trim()]=o.join("=").trim())}),s}function ae(t){try{const s={};return new URL(t).searchParams.forEach((a,n)=>{s[n]=a}),s}catch{return{}}}function re(t,s){if(!t)return{formData:null,json:null};if(s?.includes("application/json"))try{return{formData:null,json:JSON.parse(t)}}catch{return{formData:null,json:null}}return s?.includes("x-www-form-urlencoded")?{formData:t,json:null}:{formData:null,json:null}}function oe(t){return[t.requestUrl,t.requestMethod,t.requestBody||"",t.responseContent||"",t.tabName,t.requestName,t.responseStatusText,t.responseMimeType,JSON.stringify(t.requestHeaders),JSON.stringify(t.responseHeaders),JSON.stringify(t.requestQueryParams),JSON.stringify(t.requestCookies)].join(" ").toLowerCase()}function ie(t){const s=t.requestHeaders||{},a=t.responseHeaders||{},n=E(s,"content-type"),{formData:o,json:r}=re(t.requestBody,n),c={id:crypto.randomUUID(),timestamp:t.timestamp,tabId:t.tabId||0,tabName:t.tabTitle||`Tab ${t.tabId||"Unknown"}`,requestName:"",requestUrl:t.url,requestMethod:(t.method||"GET").toUpperCase(),requestHeaders:s,requestCookies:ne(E(s,"cookie")),requestQueryParams:ae(t.url),requestFormData:o,requestJson:r,requestBody:t.requestBody,responseStatus:t.responseStatus||0,responseStatusText:t.statusText||"",responseHeaders:a,responseMimeType:t.mimeType||"",responseContent:t.responseBody,searchableText:""};return c.searchableText=oe(c),c}class le{port=null;pingInterval=null;callbacks=null;connect(s,a){if(typeof chrome>"u"||!chrome.runtime?.connect){console.error("[HTTPChain] Chrome runtime not available"),a.onStatusChange("disconnected");return}this.callbacks=a,a.onStatusChange("connecting");try{this.port=chrome.runtime.connect(s,{name:"httpchain-recorder"}),this.port.onMessage.addListener(n=>{switch(n.type){case"CONNECTED":this.callbacks?.onStatusChange("connected"),this.callbacks?.onStateUpdate(n.isCapturing||!1,n.tabCount||0,n.attachedTabCount||0);break;case"PONG":break;case"STATE_UPDATE":this.callbacks?.onStateUpdate(n.isCapturing||!1,n.tabCount||0,n.attachedTabCount||0);break;case"CAPTURE_STARTED":this.callbacks?.onCaptureChange(!0,n.attachedTabCount||0);break;case"CAPTURE_STOPPED":this.callbacks?.onCaptureChange(!1,0);break;case"REQUEST_CAPTURED":if(n.data){const o=ie(n.data);this.callbacks?.onRequest(o)}break;case"ERROR":console.error("[HTTPChain]",n.error);break}}),this.port.onDisconnect.addListener(()=>{this.port=null,this.callbacks?.onStatusChange("disconnected"),this.callbacks?.onCaptureChange(!1,0),this.stopPing()}),this.startPing()}catch(n){console.error("[HTTPChain] Connection error:",n),a.onStatusChange("disconnected")}}disconnect(){this.port&&(this.port.disconnect(),this.port=null),this.stopPing(),this.callbacks?.onStatusChange("disconnected")}send(s){this.port?.postMessage(s)}startPing(){this.pingInterval=setInterval(()=>{this.send({type:"PING"})},5e3)}stopPing(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=null)}isConnected(){return this.port!==null}}const k=new le,ce={requests:{},savedRequests:{},selectedRequestId:null,searchQuery:"",connectionStatus:"disconnected",isCapturing:!1,attachedTabCount:0,availableTabCount:0,maxTabsWarningThreshold:10,maxRequestsWarningThreshold:1e3,strictRequestsLimit:!1,hasSeenTabsWarning:!1,hasSeenRequestsWarning:!1},l=V.create((t,s)=>({...ce,connect:a=>{const n={onStatusChange:o=>s().setConnectionStatus(o),onRequest:o=>s().addRequest(o),onCaptureChange:(o,r)=>s().setCapturing(o,r),onStateUpdate:(o,r,c)=>s().setExtensionState(o,r,c)};k.connect(a,n)},disconnect:()=>{k.disconnect()},startCapture:()=>{k.send({type:"START_CAPTURE"})},stopCapture:()=>{k.send({type:"STOP_CAPTURE"})},addRequest:a=>{t(n=>({requests:{...n.requests,[a.id]:a}}))},clearRequests:()=>{t({requests:{},selectedRequestId:null,hasSeenRequestsWarning:!1})},saveRequest:(a,n)=>{t(o=>{const r=o.requests[a];return r?{savedRequests:{...o.savedRequests,[a]:{...r,requestName:n}}}:o})},unsaveRequest:a=>{t(n=>{const{[a]:o,...r}=n.savedRequests;return{savedRequests:r}})},setSelectedRequestId:a=>{t({selectedRequestId:a})},setSearchQuery:a=>{t({searchQuery:a})},setConnectionStatus:a=>{t({connectionStatus:a})},setCapturing:(a,n)=>{t({isCapturing:a,attachedTabCount:n})},setExtensionState:(a,n,o)=>{t({isCapturing:a,availableTabCount:n,attachedTabCount:o})},setWarningConfig:a=>{t({...a.maxTabs!==void 0&&{maxTabsWarningThreshold:a.maxTabs},...a.maxRequests!==void 0&&{maxRequestsWarningThreshold:a.maxRequests},...a.strict!==void 0&&{strictRequestsLimit:a.strict}})},dismissTabsWarning:()=>{t({hasSeenTabsWarning:!0})},dismissRequestsWarning:()=>{t({hasSeenRequestsWarning:!0})}}));function de(t){const s=l(n=>n.connect),a=l(n=>n.setWarningConfig);return v.useEffect(()=>{s(t)},[t,s]),{setWarningConfig:a}}function u(...t){return Y.twMerge(K.clsx(t))}function ue({className:t,type:s,...a}){return e.jsx("input",{type:s,"data-slot":"input",className:u("dark:bg-input/30 border-input focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 disabled:bg-input/50 dark:disabled:bg-input/80 h-8 rounded-none border bg-transparent px-2.5 py-1 text-xs transition-colors file:h-6 file:text-xs file:font-medium focus-visible:ring-1 aria-invalid:ring-1 md:text-xs file:text-foreground placeholder:text-muted-foreground w-full min-w-0 outline-none file:inline-flex file:border-0 file:bg-transparent disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",t),...a})}const he=O.cva("focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:aria-invalid:border-destructive/50 rounded-none border border-transparent bg-clip-padding text-xs font-medium focus-visible:ring-1 aria-invalid:ring-1 [&_svg:not([class*='size-'])]:size-4 inline-flex items-center justify-center whitespace-nowrap transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none shrink-0 [&_svg]:shrink-0 outline-none group/button select-none",{variants:{variant:{default:"bg-primary text-primary-foreground [a]:hover:bg-primary/80",outline:"border-border bg-background hover:bg-muted hover:text-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 aria-expanded:bg-muted aria-expanded:text-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 aria-expanded:bg-secondary aria-expanded:text-secondary-foreground",ghost:"hover:bg-muted hover:text-foreground dark:hover:bg-muted/50 aria-expanded:bg-muted aria-expanded:text-foreground",destructive:"bg-destructive/10 hover:bg-destructive/20 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/20 text-destructive focus-visible:border-destructive/40 dark:hover:bg-destructive/30",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-8 gap-1.5 px-2.5 has-data-[icon=inline-end]:pr-2 has-data-[icon=inline-start]:pl-2",xs:"h-6 gap-1 rounded-none px-2 text-xs has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5 [&_svg:not([class*='size-'])]:size-3",sm:"h-7 gap-1 rounded-none px-2.5 has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5 [&_svg:not([class*='size-'])]:size-3.5",lg:"h-9 gap-1.5 px-2.5 has-data-[icon=inline-end]:pr-3 has-data-[icon=inline-start]:pl-3",icon:"size-8","icon-xs":"size-6 rounded-none [&_svg:not([class*='size-'])]:size-3","icon-sm":"size-7 rounded-none","icon-lg":"size-9"}},defaultVariants:{variant:"default",size:"default"}});function C({className:t,variant:s="default",size:a="default",asChild:n=!1,...o}){const r=n?g.Slot.Root:"button";return e.jsx(r,{"data-slot":"button","data-variant":s,"data-size":a,className:u(he({variant:s,size:a,className:t})),...o})}const A=25;function T(t,s){const a=t.toLowerCase(),n=s.toLowerCase(),o=a.indexOf(n);if(o===-1)return null;const r=Math.max(0,o-A),c=Math.min(t.length,o+s.length+A),i=r>0?"...":"",h=c<t.length?"...":"";return{matchedText:`${i}${t.slice(r,c)}${h}`,highlightText:t.slice(o,o+s.length)}}function L(t,s){return v.useMemo(()=>{if(!s.trim())return t.map(n=>({request:n,matchedField:"",matchedText:"",highlightText:""}));const a=s.toLowerCase();return t.filter(n=>n.searchableText?.includes(a)).map(n=>{let o=T(n.requestUrl,s),r="URL";if(!o&&n.responseContent&&(o=T(n.responseContent,s),r="Response"),!o&&n.requestBody&&(o=T(n.requestBody,s),r="Request Body"),!o){const c=JSON.stringify(n.requestHeaders);o=T(c,s),r="Headers"}return{request:n,matchedField:r,matchedText:o?.matchedText||"",highlightText:o?.highlightText||s}})},[t,s])}function xe(){const t=l(d=>d.searchQuery),s=l(d=>d.setSearchQuery),a=l(d=>d.clearRequests),n=l(d=>d.startCapture),o=l(d=>d.stopCapture),r=l(d=>d.isCapturing),c=l(d=>d.connectionStatus),i=l(d=>d.requests),h=v.useMemo(()=>Object.values(i),[i]),f=L(h,t),p=c==="connected";return e.jsxs("div",{className:"h-full p-3 space-y-3 bg-background overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx(x.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(ue,{type:"text",placeholder:"Search requests...",value:t,onChange:d=>s(d.target.value),className:"pl-9 h-8"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t?`${f.length} of ${h.length}`:h.length," requests"]}),r&&e.jsxs("span",{className:"flex items-center gap-1 text-destructive",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-current animate-pulse"}),"Live"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{size:"sm",variant:"ghost",onClick:a,disabled:h.length===0,className:"h-8 w-8 p-0",title:"Clear all requests",children:e.jsx(x.Trash2,{className:"h-4 w-4"})}),r?e.jsx(C,{size:"sm",variant:"ghost",onClick:o,className:"h-8 w-8 p-0 text-destructive hover:text-destructive hover:bg-destructive/10",title:"Stop capture",children:e.jsx(x.Square,{className:"h-4 w-4 fill-current"})}):e.jsx(C,{size:"sm",variant:"ghost",onClick:n,disabled:!p,className:"h-8 w-8 p-0 text-emerald-500 hover:text-emerald-600 hover:bg-emerald-500/10",title:"Start capture",children:e.jsx(x.Play,{className:"h-4 w-4 fill-current"})})]})]})]})}const me=O.cva("h-5 gap-1 rounded-none border border-transparent px-2 py-0.5 text-xs font-medium transition-all has-data-[icon=inline-end]:pr-1.5 has-data-[icon=inline-start]:pl-1.5 [&>svg]:size-3! inline-flex items-center justify-center w-fit whitespace-nowrap shrink-0 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-colors overflow-hidden group/badge",{variants:{variant:{default:"bg-primary text-primary-foreground [a]:hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground [a]:hover:bg-secondary/80",destructive:"bg-destructive/10 [a]:hover:bg-destructive/20 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 text-destructive dark:bg-destructive/20",outline:"border-border text-foreground [a]:hover:bg-muted [a]:hover:text-muted-foreground",ghost:"hover:bg-muted hover:text-muted-foreground dark:hover:bg-muted/50",link:"text-primary underline-offset-4 hover:underline"}},defaultVariants:{variant:"default"}});function S({className:t,variant:s="default",asChild:a=!1,...n}){const o=a?g.Slot.Root:"span";return e.jsx(o,{"data-slot":"badge","data-variant":s,className:u(me({variant:s}),t),...n})}function pe({text:t,highlight:s}){if(!s||!t)return e.jsx("span",{children:t});const a=t.split(new RegExp(`(${s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"));return e.jsx("span",{children:a.map((n,o)=>n.toLowerCase()===s.toLowerCase()?e.jsx("mark",{className:"bg-primary/30 text-primary rounded-sm px-0.5",children:n},o):n)})}function fe(t,s=60){try{const a=new URL(t),n=a.pathname+a.search;return n.length<=s?n:n.slice(0,s)+"..."}catch{return t.length<=s?t:t.slice(0,s)+"..."}}function ge(t){return new Date(t).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}function be({result:t,isSelected:s,isSaved:a,onSelect:n,style:o}){const{request:r,matchedText:c,highlightText:i}=t,h=r.responseStatus>=200&&r.responseStatus<300,f=r.responseStatus>=400;return e.jsxs("div",{style:o,onClick:n,className:`group cursor-pointer border-b px-4 py-3 transition-colors hover:bg-muted/50 overflow-hidden ${s?"bg-muted border-l-2 border-l-primary":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(S,{variant:"secondary",className:"shrink-0 font-mono text-[11px] font-bold px-2 py-0.5",children:r.requestMethod}),e.jsx(S,{variant:"outline",className:`shrink-0 text-[11px] font-medium px-2 py-0.5 ${f?"border-destructive text-destructive":h?"border-primary text-primary":"border-muted-foreground/50"}`,children:r.responseStatus||"..."}),a&&e.jsx(x.Bookmark,{className:"h-3.5 w-3.5 shrink-0 fill-primary text-primary"}),e.jsx("span",{className:"ml-auto font-mono text-[11px] text-muted-foreground shrink-0",children:ge(r.timestamp)})]}),e.jsx("p",{className:"font-mono text-[13px] text-foreground/90 truncate font-medium mb-1",title:r.requestUrl,children:fe(r.requestUrl)}),c&&e.jsx("p",{className:"text-[11px] text-muted-foreground mt-1 line-clamp-2 break-all leading-tight",children:e.jsx(pe,{text:c,highlight:i})})]})}const ve=72,je=104;function Ne(){const t=l(m=>m.searchQuery),s=l(m=>m.selectedRequestId),a=l(m=>m.setSelectedRequestId),n=l(m=>m.savedRequests),o=l(m=>m.isCapturing),r=l(m=>m.requests),c=v.useMemo(()=>Object.values(r),[r]),h=t.trim().length>0?je:ve,f=v.useRef(null),[p,d]=v.useState({width:360,height:400}),R=L(c,t),w=v.useMemo(()=>{const m=[],q=[];return R.forEach(N=>{N.request.id in n?m.push(N):q.push(N)}),[...m,...q]},[R,n]);v.useEffect(()=>{const m=f.current;if(!m)return;const q=()=>{const j=m.getBoundingClientRect();j.width>0&&j.height>0&&d({width:j.width,height:j.height})};q();const N=new ResizeObserver(q);return N.observe(m),()=>N.disconnect()},[]);const b=v.useCallback(({columnIndex:m,rowIndex:q,style:N})=>{const j=w[q];if(!j)return e.jsx("div",{style:N});const J=j.request.id in n;return e.jsx(be,{result:j,isSelected:s===j.request.id,isSaved:J,onSelect:()=>a(j.request.id),style:N})},[w,s,n,a]);return w.length===0?e.jsxs("div",{ref:f,className:"h-full w-full flex flex-col items-center justify-center p-6 text-center text-muted-foreground",children:[e.jsx("p",{className:"text-sm font-medium",children:"No requests"}),e.jsx("p",{className:"mt-1 text-xs",children:o?"Waiting for network activity...":""})]}):e.jsxs("div",{ref:f,className:"h-full w-full overflow-hidden sidebar-list-container",children:[e.jsx("style",{children:`
                .sidebar-list-container > div {
                    scrollbar-width: none;
                    -ms-overflow-style: none;
                }
                .sidebar-list-container > div::-webkit-scrollbar {
                    display: none;
                }
            `}),e.jsx(X.Grid,{columnCount:1,columnWidth:p.width,defaultHeight:p.height,defaultWidth:p.width,rowCount:w.length,rowHeight:h,cellComponent:b,cellProps:{},style:{height:p.height,width:"100%"}})]})}function Ce(t){if(t.startsWith("data:")){const s=t.indexOf(",");return{protocol:"data:",host:(s>0?t.slice(5,Math.min(s,50)):"unknown")+(s>50?"...":""),path:`[${((t.length-s)/1024).toFixed(1)} KB payload]`,isDataUrl:!0}}try{const s=new URL(t);return{protocol:s.protocol,host:s.host,path:s.pathname+s.search+s.hash,isDataUrl:!1}}catch{return{protocol:"",host:"",path:t,isDataUrl:!1}}}function qe(){const t=l(b=>b.selectedRequestId),s=l(b=>b.requests),a=l(b=>b.savedRequests),n=l(b=>b.saveRequest),o=l(b=>b.unsaveRequest),r=t?s[t]??a[t]??null:null,[c,i]=v.useState(!1),h=t?t in a:!1;if(!r)return e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground"});const f=r.responseStatus>=200&&r.responseStatus<300,p=r.responseStatus>=400,d=Ce(r.requestUrl),R=async()=>{await navigator.clipboard.writeText(r.requestUrl),i(!0),setTimeout(()=>i(!1),2e3)},w=()=>{if(t)if(h)o(t);else{const b=d.path.split("/").pop()||"Request";n(t,b)}};return e.jsxs("div",{className:"h-full flex flex-col p-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(S,{variant:"secondary",className:"font-mono font-bold text-sm px-2.5 py-0.5",children:r.requestMethod}),e.jsxs(S,{variant:p?"destructive":f?"default":"secondary",className:"font-mono text-sm px-2.5 py-0.5",children:[r.responseStatus," ",r.responseStatusText]}),r.responseMimeType&&e.jsx(S,{variant:"outline",className:"text-xs hidden sm:inline-flex",children:r.responseMimeType}),e.jsx("div",{className:"flex-1"}),e.jsx(C,{size:"sm",variant:h?"default":"outline",onClick:w,className:"shrink-0 gap-1.5",title:h?"Remove from saved":"Save request",children:h?e.jsxs(e.Fragment,{children:[e.jsx(x.BookmarkCheck,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Saved"})]}):e.jsxs(e.Fragment,{children:[e.jsx(x.Bookmark,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Save"})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx(x.Globe,{className:"h-4 w-4 shrink-0 text-primary"}),e.jsx("p",{className:"font-mono text-sm text-foreground/80 truncate flex-1",title:r.requestUrl,children:d.isDataUrl?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:d.protocol}),e.jsx("span",{children:d.host}),e.jsx("span",{className:"text-muted-foreground ml-1",children:d.path})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-muted-foreground",children:[d.protocol,"//"]}),e.jsx("span",{className:"font-medium",children:d.host}),e.jsx("span",{className:"text-foreground/60",children:d.path})]})}),e.jsx(C,{size:"sm",variant:"ghost",onClick:R,className:"shrink-0 h-7 w-7 p-0",title:"Copy URL",children:c?e.jsx(x.Check,{className:"h-3.5 w-3.5 text-green-500"}):e.jsx(x.Copy,{className:"h-3.5 w-3.5"})})]})]})}function D({className:t,children:s,viewPortRef:a,...n}){return e.jsxs(g.ScrollArea.Root,{"data-slot":"scroll-area",className:u("relative",t),...n,children:[e.jsx(g.ScrollArea.Viewport,{ref:a,"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:s}),e.jsx(ye,{}),e.jsx(g.ScrollArea.Corner,{})]})}function ye({className:t,orientation:s="vertical",...a}){return e.jsx(g.ScrollArea.ScrollAreaScrollbar,{"data-slot":"scroll-area-scrollbar","data-orientation":s,orientation:s,className:u("data-horizontal:h-2.5 data-horizontal:flex-col data-horizontal:border-t data-horizontal:border-t-transparent data-vertical:h-full data-vertical:w-2.5 data-vertical:border-l data-vertical:border-l-transparent flex touch-none p-px transition-colors select-none",t),...a,children:e.jsx(g.ScrollArea.ScrollAreaThumb,{"data-slot":"scroll-area-thumb",className:"rounded-none bg-border relative flex-1"})})}function we({className:t,...s}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:u("w-full caption-bottom text-xs",t),...s})})}function Se({className:t,...s}){return e.jsx("thead",{"data-slot":"table-header",className:u("[&_tr]:border-b",t),...s})}function Re({className:t,...s}){return e.jsx("tbody",{"data-slot":"table-body",className:u("[&_tr:last-child]:border-0",t),...s})}function I({className:t,...s}){return e.jsx("tr",{"data-slot":"table-row",className:u("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function P({className:t,...s}){return e.jsx("th",{"data-slot":"table-head",className:u("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0",t),...s})}function H({className:t,...s}){return e.jsx("td",{"data-slot":"table-cell",className:u("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0",t),...s})}function z({data:t,title:s,icon:a}){const n=Object.entries(t??{}),[o,r]=v.useState(null);if(n.length===0)return e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground mb-2",children:[a&&e.jsx(a,{className:"h-3.5 w-3.5"}),s]}),e.jsxs("p",{className:"text-xs text-muted-foreground/60 italic",children:["No ",s.toLowerCase()]})]});const c=i=>{r(o===i?null:i)};return e.jsxs("div",{className:"mb-6 max-w-full overflow-hidden",children:[e.jsxs("h4",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground mb-2",children:[a&&e.jsx(a,{className:"h-3.5 w-3.5"}),s]}),e.jsx("div",{className:"rounded border overflow-hidden",children:e.jsxs(we,{className:"table-fixed w-full",children:[e.jsx(Se,{children:e.jsxs(I,{className:"bg-muted/30",children:[e.jsx(P,{className:"w-[180px] text-xs font-medium",children:"Name"}),e.jsx(P,{className:"text-xs font-medium",children:"Value"})]})}),e.jsx(Re,{children:n.map(([i,h])=>{const f=o===i;return e.jsxs(I,{onClick:()=>c(i),className:u("cursor-pointer transition-colors hover:bg-muted/50",f&&"bg-muted/30"),children:[e.jsx(H,{className:u("font-mono text-xs py-2 text-muted-foreground align-top",f?"whitespace-pre-wrap break-all":"truncate"),children:i}),e.jsx(H,{className:u("font-mono text-xs py-2",f?"whitespace-pre-wrap break-all":"truncate"),children:h})]},i)})})]})})]})}const ke=2e4;function U({content:t,language:s}){if(!t)return e.jsx("div",{className:"h-full flex items-center justify-center text-muted-foreground text-sm",children:"No content"});const a=t.length,n=(a/1024).toFixed(1),o=a>ke;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs(S,{variant:"outline",className:"text-[10px]",children:[n," KB"]}),o&&e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Syntax highlighting disabled (file too large)"})]}),e.jsx("div",{className:"rounded border bg-muted/30 overflow-hidden max-w-full",children:o?e.jsx("pre",{className:"font-mono text-xs whitespace-pre-wrap break-all p-4 overflow-x-hidden",children:t}):e.jsx(ee.Prism,{language:s||"text",style:te.oneDark,customStyle:{margin:0,padding:"1rem",fontSize:"12px",background:"transparent",wordBreak:"break-all",whiteSpace:"pre-wrap",overflowWrap:"break-word"},wrapLongLines:!0,codeTagProps:{style:{wordBreak:"break-all",whiteSpace:"pre-wrap",overflowWrap:"break-word"}},children:t})})]})}function Te(t){return t?t.includes("json")?"json":t.includes("xml")?"xml":t.includes("html")?"html":t.includes("javascript")?"javascript":t.includes("css")?"css":"text":"text"}const De=[{value:"request",label:"Request",icon:x.FileInput},{value:"payload",label:"Payload",icon:x.Code},{value:"response",label:"Response",icon:x.ArrowDownToLine},{value:"data",label:"Data",icon:x.Database}];function ze(){const t=l(i=>i.selectedRequestId),s=l(i=>i.requests),a=l(i=>i.savedRequests),n=t?s[t]??a[t]??null:null;if(!n)return e.jsx("div",{className:"h-full flex flex-col items-center justify-center text-muted-foreground",children:e.jsx("p",{className:"text-sm font-medium",children:"Select a request"})});const o=n.requestJson?JSON.stringify(n.requestJson,null,2):n.requestFormData||n.requestBody||"",r=n.requestJson?"json":"text",c=Te(n.responseMimeType);return e.jsxs(y.Root,{defaultValue:"request",className:"h-full flex flex-col overflow-hidden",children:[e.jsx(y.List,{className:"shrink-0 flex border-b px-4 gap-1",children:De.map(i=>{const h=i.icon;return e.jsxs(y.Trigger,{value:i.value,className:u("flex items-center gap-1.5 px-3 py-2 text-xs font-medium text-muted-foreground","border-b-2 border-transparent -mb-px","hover:text-foreground transition-colors","data-[state=active]:text-foreground data-[state=active]:border-primary"),children:[e.jsx(h,{className:"h-3.5 w-3.5"}),i.label]},i.value)})}),e.jsxs("div",{className:"flex-1 min-h-0 overflow-hidden pt-2",children:[e.jsx(y.Content,{value:"request",className:"h-full focus:outline-none data-[state=inactive]:hidden",children:e.jsx(D,{className:"h-full",children:e.jsxs("div",{className:"p-4",children:[e.jsx(z,{data:n.requestHeaders,title:"Request Headers",icon:x.Braces}),e.jsx(z,{data:n.requestCookies,title:"Request Cookies",icon:x.Cookie}),e.jsx(z,{data:n.requestQueryParams,title:"Query Parameters",icon:x.Braces})]})})}),e.jsx(y.Content,{value:"payload",className:"h-full focus:outline-none data-[state=inactive]:hidden",children:e.jsx(D,{className:"h-full",children:e.jsx("div",{className:"p-4",children:e.jsx(U,{content:o||null,language:r})})})}),e.jsx(y.Content,{value:"response",className:"h-full focus:outline-none data-[state=inactive]:hidden",children:e.jsx(D,{className:"h-full",children:e.jsx("div",{className:"p-4",children:e.jsx(z,{data:n.responseHeaders,title:"Response Headers",icon:x.Braces})})})}),e.jsx(y.Content,{value:"data",className:"h-full focus:outline-none data-[state=inactive]:hidden",children:e.jsx(D,{className:"h-full",children:e.jsx("div",{className:"p-4",children:e.jsx(U,{content:n.responseContent,language:c})})})})]})]})}function Ee(){const t=l(n=>n.connectionStatus),s=t==="connected",a=t==="connecting";return e.jsxs("div",{className:"absolute bottom-4 right-4 z-50 flex items-center gap-2 rounded-full border bg-card px-3 py-1.5 shadow-lg",children:[e.jsx("span",{className:`h-2 w-2 rounded-full ${s?"bg-primary":a?"bg-muted-foreground animate-pulse":"bg-destructive"}`}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s?"Connected":a?"Connecting...":"Disconnected"})]})}function Ae({extensionId:t}){const s=l(p=>p.connectionStatus),a=l(p=>p.startCapture),n=l(p=>Object.keys(p.requests).length),o=l(p=>p.availableTabCount),r=l(p=>p.isCapturing);if(n>0)return null;const c=s==="connected",i=s==="connecting",h=o>0,f=()=>{window.open(`chrome://extensions/?id=${t}`,"_blank")};return e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-background/95 z-10",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-center max-w-xs",children:[e.jsx("div",{className:"p-4 rounded-full bg-muted",children:r?e.jsx(x.Radio,{className:"h-8 w-8 text-destructive animate-pulse"}):e.jsx(x.Unplug,{className:"h-8 w-8 text-muted-foreground"})}),r?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Waiting for requests..."}),e.jsx("p",{className:"text-xs text-muted-foreground/60",children:"Navigate to a page in one of the captured tabs"})]}):i?e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connecting to extension..."})}):c?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:h?`${o} tab${o!==1?"s":""} available`:"No active tabs detected"}),e.jsxs(C,{onClick:a,className:"gap-2",disabled:!h,children:[e.jsx(x.Play,{className:"h-4 w-4"}),"Start Capture"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Extension not connected"}),e.jsxs(C,{variant:"outline",onClick:f,className:"gap-2",children:[e.jsx(x.ExternalLink,{className:"h-4 w-4"}),"Install Extension"]})]})]})})}function _({...t}){return e.jsx(g.AlertDialog.Root,{"data-slot":"alert-dialog",...t})}function Ie({...t}){return e.jsx(g.AlertDialog.Portal,{"data-slot":"alert-dialog-portal",...t})}function Pe({className:t,...s}){return e.jsx(g.AlertDialog.Overlay,{"data-slot":"alert-dialog-overlay",className:u("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/10 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 z-50",t),...s})}function M({className:t,size:s="default",...a}){return e.jsxs(Ie,{children:[e.jsx(Pe,{}),e.jsx(g.AlertDialog.Content,{"data-slot":"alert-dialog-content","data-size":s,className:u("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/10 gap-4 rounded-none p-4 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-sm group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",t),...a})]})}function B({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:u("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-4 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",t),...s})}function F({className:t,...s}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:u("flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",t),...s})}function Q({className:t,...s}){return e.jsx(g.AlertDialog.Title,{"data-slot":"alert-dialog-title",className:u("text-sm font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",t),...s})}function $({className:t,...s}){return e.jsx(g.AlertDialog.Description,{"data-slot":"alert-dialog-description",className:u("text-muted-foreground *:[a]:hover:text-foreground text-xs/relaxed text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",t),...s})}function G({className:t,variant:s="default",size:a="default",...n}){return e.jsx(C,{variant:s,size:a,asChild:!0,children:e.jsx(g.AlertDialog.Action,{"data-slot":"alert-dialog-action",className:u(t),...n})})}function He({className:t,variant:s="outline",size:a="default",...n}){return e.jsx(C,{variant:s,size:a,asChild:!0,children:e.jsx(g.AlertDialog.Cancel,{"data-slot":"alert-dialog-cancel",className:u(t),...n})})}function Ue(){const t=l(r=>r.attachedTabCount),s=l(r=>r.maxTabsWarningThreshold),a=l(r=>r.hasSeenTabsWarning),n=l(r=>r.dismissTabsWarning);return t>s&&!a?e.jsx(_,{open:!0,children:e.jsxs(M,{children:[e.jsxs(B,{children:[e.jsx(Q,{children:"⚠️ Many Tabs Attached"}),e.jsxs($,{children:["You are capturing from ",e.jsxs("strong",{children:[t," tabs"]}),". This may significantly impact browser performance and memory usage."]})]}),e.jsx(F,{children:e.jsx(G,{onClick:n,children:"Okay"})})]})}):null}function We(){const t=l(i=>i.maxRequestsWarningThreshold),s=l(i=>i.hasSeenRequestsWarning),a=l(i=>i.strictRequestsLimit),n=l(i=>i.clearRequests),o=l(i=>i.dismissRequestsWarning),r=l(i=>Object.keys(i.requests).length);return r>t&&(a||!s)?e.jsx(_,{open:!0,children:e.jsxs(M,{children:[e.jsxs(B,{children:[e.jsx(Q,{children:"⚠️ High Request Count — Risk of Data Loss"}),e.jsx($,{className:"space-y-2",children:a?e.jsxs("p",{children:["You have captured ",e.jsx("strong",{children:r})," requests.",e.jsx("strong",{children:" You must clear requests to continue."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["You have captured ",e.jsx("strong",{children:r})," requests. The application may become ",e.jsx("strong",{children:"unresponsive"})," or ",e.jsx("strong",{children:"crash"}),"."]}),e.jsx("p",{className:"text-destructive font-medium",children:"⚠️ If the page crashes, you will lose all captured data."})]})})]}),e.jsxs(F,{children:[!a&&e.jsx(He,{onClick:o,children:"I Understand the Risk"}),e.jsx(G,{onClick:n,children:"Clear Requests"})]})]})}):null}const W=100;function Oe({extensionId:t,maxRequestsWarningThreshold:s=1e3,maxTabsWarningThreshold:a=10,strictRequestsLimit:n=!1,className:o}){de(t);const r=l(c=>c.setWarningConfig);return v.useEffect(()=>{r({maxTabs:a,maxRequests:s,strict:n})},[a,s,n,r]),e.jsxs("div",{className:`relative h-full w-full flex bg-background text-foreground overflow-hidden ${o??""}`,children:[e.jsxs("div",{className:"w-[25%] h-full flex flex-col border-r",children:[e.jsx("div",{style:{height:W,flexShrink:0},className:"border-b",children:e.jsx(xe,{})}),e.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:e.jsx(Ne,{})})]}),e.jsxs("div",{className:"w-[75%] h-full flex flex-col",children:[e.jsx("div",{style:{height:W,flexShrink:0},className:"border-b",children:e.jsx(qe,{})}),e.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:e.jsx(ze,{})})]}),e.jsx(Ee,{}),e.jsx(Ae,{extensionId:t}),e.jsx(Ue,{}),e.jsx(We,{})]})}function Le(){const t=l(s=>s.savedRequests);return Object.values(t)}exports.HttpChainWebRecorder=Oe;exports.useBookmarkedRequests=Le;
